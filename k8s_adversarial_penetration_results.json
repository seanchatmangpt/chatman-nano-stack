{
  "rbac_analysis": {
    "total_issues": 0,
    "critical_issues": 0,
    "high_issues": 0,
    "vulnerabilities": []
  },
  "container_security_analysis": {
    "total_issues": 12,
    "critical_issues": 9,
    "high_issues": 0,
    "vulnerabilities": [
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Privileged container detected",
        "resource": "container_security_context",
        "attack_vector": "Privileged containers can escape to host system",
        "mitigation": "Remove privileged: true and use specific capabilities instead"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "medium",
        "category": "privilege_escalation",
        "description": "Container running as root user",
        "resource": "security_context",
        "attack_vector": "Root user increases attack surface and privilege escalation risk",
        "mitigation": "Use non-root user (runAsUser: 1000) and runAsNonRoot: true"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Privileged container detected",
        "resource": "container_security_context",
        "attack_vector": "Privileged containers can escape to host system",
        "mitigation": "Remove privileged: true and use specific capabilities instead"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "medium",
        "category": "privilege_escalation",
        "description": "Container running as root user",
        "resource": "security_context",
        "attack_vector": "Root user increases attack surface and privilege escalation risk",
        "mitigation": "Use non-root user (runAsUser: 1000) and runAsNonRoot: true"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "medium",
        "category": "privilege_escalation",
        "description": "Container running as root user",
        "resource": "security_context",
        "attack_vector": "Root user increases attack surface and privilege escalation risk",
        "mitigation": "Use non-root user (runAsUser: 1000) and runAsNonRoot: true"
      }
    ]
  },
  "network_policy_analysis": {
    "network_policies_found": 4,
    "total_issues": 0,
    "critical_issues": 0,
    "high_issues": 0,
    "vulnerabilities": []
  },
  "secret_security_analysis": {
    "total_issues": 5,
    "critical_issues": 0,
    "high_issues": 4,
    "vulnerabilities": [
      {
        "severity": "medium",
        "category": "secret_exposure",
        "description": "Base64 encoded secret visible in configuration",
        "resource": "kubernetes_secret",
        "attack_vector": "Base64 encoding is not encryption, secrets are easily decoded",
        "mitigation": "Use proper secret management with encryption at rest"
      },
      {
        "severity": "high",
        "category": "secret_access",
        "description": "Overly permissive secret access permissions",
        "resource": "rbac_rule",
        "attack_vector": "Broad secret access enables credential theft",
        "mitigation": "Restrict secret access to specific secrets and necessary verbs"
      },
      {
        "severity": "high",
        "category": "secret_exposure",
        "description": "Hardcoded password detected",
        "resource": "terraform_configuration",
        "attack_vector": "Hardcoded secrets in configuration can be extracted",
        "mitigation": "Use Kubernetes secrets or external secret management"
      },
      {
        "severity": "high",
        "category": "secret_exposure",
        "description": "Hardcoded API key detected",
        "resource": "terraform_configuration",
        "attack_vector": "Hardcoded secrets in configuration can be extracted",
        "mitigation": "Use Kubernetes secrets or external secret management"
      },
      {
        "severity": "high",
        "category": "secret_access",
        "description": "Overly permissive secret access permissions",
        "resource": "rbac_rule",
        "attack_vector": "Broad secret access enables credential theft",
        "mitigation": "Restrict secret access to specific secrets and necessary verbs"
      }
    ]
  },
  "attack_simulation": {
    "total_scenarios": 4,
    "vulnerable_scenarios": 0,
    "critical_vulnerabilities": 0,
    "scenarios": [
      {
        "scenario": "Kubernetes Dashboard RCE (CVE-2018-18264)",
        "vulnerable": false,
        "severity": "critical",
        "impact": "Full cluster compromise",
        "findings": [],
        "attack_steps": [
          "Identify dashboard service account",
          "Check for overprivileged permissions",
          "Exploit dashboard to gain cluster access"
        ]
      },
      {
        "scenario": "Service Account Token Theft",
        "vulnerable": false,
        "severity": "high",
        "impact": "Unauthorized API access with service account privileges",
        "findings": [],
        "attack_steps": [
          "Access container filesystem",
          "Read /var/run/secrets/kubernetes.io/serviceaccount/token",
          "Use token for API access"
        ]
      },
      {
        "scenario": "Container Escape via Docker Socket",
        "vulnerable": false,
        "severity": "critical",
        "impact": "Host system compromise",
        "findings": [],
        "attack_steps": [
          "Access mounted /var/run/docker.sock",
          "Create privileged container",
          "Mount host filesystem",
          "Escape to host system"
        ]
      },
      {
        "scenario": "RBAC Privilege Escalation",
        "vulnerable": false,
        "severity": "critical",
        "impact": "Cluster admin privileges",
        "findings": [],
        "attack_steps": [
          "Identify wildcard RBAC permissions",
          "Create malicious resources",
          "Escalate to cluster admin"
        ]
      }
    ]
  },
  "penetration_testing_report": {
    "timestamp": 1753393701.476844,
    "testing_duration": "Static Analysis",
    "scope": "Kubernetes Terraform Configuration",
    "methodology": "OWASP Kubernetes Security Testing Guide",
    "risk_assessment": {
      "overall_risk_score": 134,
      "risk_percentage": 100,
      "security_posture": "CRITICAL"
    },
    "vulnerability_summary": {
      "total_vulnerabilities": 17,
      "critical": 9,
      "high": 4,
      "medium": 4,
      "low": 0
    },
    "top_vulnerabilities": [
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Privileged container detected",
        "resource": "container_security_context",
        "attack_vector": "Privileged containers can escape to host system",
        "mitigation": "Remove privileged: true and use specific capabilities instead"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Privileged container detected",
        "resource": "container_security_context",
        "attack_vector": "Privileged containers can escape to host system",
        "mitigation": "Remove privileged: true and use specific capabilities instead"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "critical",
        "category": "container_escape",
        "description": "Dangerous host path mount: /",
        "resource": "hostPath_volume",
        "attack_vector": "Host path / enables container escape",
        "mitigation": "Remove host path mount / or use read-only access"
      },
      {
        "severity": "high",
        "category": "secret_access",
        "description": "Overly permissive secret access permissions",
        "resource": "rbac_rule",
        "attack_vector": "Broad secret access enables credential theft",
        "mitigation": "Restrict secret access to specific secrets and necessary verbs"
      }
    ],
    "remediation_priority": [
      "Fix all CRITICAL vulnerabilities immediately",
      "Address HIGH severity issues within 7 days",
      "Plan remediation for MEDIUM issues within 30 days",
      "Review LOW severity findings for completeness"
    ]
  },
  "adversarial_testing_summary": {
    "total_duration": 0.0033050421625375748,
    "tests_executed": 5,
    "vulnerabilities_found": 17,
    "critical_vulnerabilities": 9,
    "high_vulnerabilities": 4,
    "security_testing_complete": true,
    "timestamp": 1753393701.476853
  }
}