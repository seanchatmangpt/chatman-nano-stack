@prefix aegis: <http://cns.aegis/fabric#> .
@prefix threat: <http://cns.aegis/threat#> .
@prefix rule: <http://cns.aegis/rule#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# CNS Aegis Fabric Threat Ontology
# Defines threat signatures, detection rules, and response actions

aegis:ThreatSignature a owl:Class ;
    rdfs:label "Threat Signature" ;
    rdfs:comment "Base class for all threat signatures in the Aegis Fabric" .

aegis:NetworkThreat rdfs:subClassOf aegis:ThreatSignature ;
    rdfs:label "Network-based Threat" .

aegis:ApplicationThreat rdfs:subClassOf aegis:ThreatSignature ;
    rdfs:label "Application-layer Threat" .

aegis:SystemThreat rdfs:subClassOf aegis:ThreatSignature ;
    rdfs:label "System-level Threat" .

# 80/20 Optimized Threat Categories (20% that catch 80% of threats)
threat:SQLInjection a aegis:ApplicationThreat ;
    aegis:priority "critical" ;
    aegis:detectionPattern "('|(--|;)|(<|>)|union|select|insert|update|delete|drop|create|alter|exec|execute|script|javascript|eval)" ;
    aegis:propagationSpeed "100ms" ;
    aegis:falsePositiveRate "0.001" .

threat:XSSAttack a aegis:ApplicationThreat ;
    aegis:priority "critical" ;
    aegis:detectionPattern "(<script|<iframe|javascript:|onerror=|onload=|onclick=|<svg/onload)" ;
    aegis:propagationSpeed "100ms" ;
    aegis:falsePositiveRate "0.002" .

threat:DDoSAttack a aegis:NetworkThreat ;
    aegis:priority "critical" ;
    aegis:detectionPattern "rate_limit_exceeded" ;
    aegis:thresholdRPS 10000 ;
    aegis:propagationSpeed "50ms" ;
    aegis:falsePositiveRate "0.005" .

threat:BruteForceAttack a aegis:SystemThreat ;
    aegis:priority "high" ;
    aegis:detectionPattern "failed_auth_attempts" ;
    aegis:thresholdAttempts 5 ;
    aegis:timeWindowSeconds 60 ;
    aegis:propagationSpeed "200ms" ;
    aegis:falsePositiveRate "0.003" .

threat:PrivilegeEscalation a aegis:SystemThreat ;
    aegis:priority "critical" ;
    aegis:detectionPattern "unauthorized_privilege_change" ;
    aegis:propagationSpeed "50ms" ;
    aegis:falsePositiveRate "0.001" .

# Detection Rules
rule:DetectionRule a owl:Class ;
    rdfs:label "Detection Rule" ;
    rdfs:comment "Rules for detecting threats in the Aegis Fabric" .

rule:NetworkRule rdfs:subClassOf rule:DetectionRule ;
    aegis:layer "network" ;
    aegis:processingOrder 1 .

rule:ApplicationRule rdfs:subClassOf rule:DetectionRule ;
    aegis:layer "application" ;
    aegis:processingOrder 2 .

rule:BehavioralRule rdfs:subClassOf rule:DetectionRule ;
    aegis:layer "behavioral" ;
    aegis:processingOrder 3 .

# Response Actions
aegis:ResponseAction a owl:Class ;
    rdfs:label "Response Action" ;
    rdfs:comment "Actions taken when threats are detected" .

aegis:BlockAction a aegis:ResponseAction ;
    aegis:severity "immediate" ;
    aegis:duration "permanent" .

aegis:RateLimitAction a aegis:ResponseAction ;
    aegis:severity "moderate" ;
    aegis:duration "300s" .

aegis:AlertAction a aegis:ResponseAction ;
    aegis:severity "informational" ;
    aegis:duration "0s" .

aegis:IsolateAction a aegis:ResponseAction ;
    aegis:severity "critical" ;
    aegis:duration "until_cleared" .

# Gossip Protocol Configuration
aegis:GossipProtocol a owl:Class ;
    aegis:fanout 3 ;
    aegis:interval "100ms" ;
    aegis:maxHops 5 ;
    aegis:convergenceTarget "1000ms" .

# BitActor Agent Configuration
aegis:BitActorAgent a owl:Class ;
    aegis:coreEngine "bitactor_production" ;
    aegis:protectionModule "enhanced_protection" ;
    aegis:memoryLimit "512MB" ;
    aegis:cpuLimit "2000m" ;
    aegis:replicaCount 3 .

# Service Mesh Configuration
aegis:ServiceMesh a owl:Class ;
    aegis:provider "linkerd" ;
    aegis:mtlsEnabled true ;
    aegis:circuitBreakerThreshold 5 ;
    aegis:retryAttempts 3 ;
    aegis:timeoutMs 5000 .

# Performance Targets
aegis:PerformanceTarget a owl:Class ;
    aegis:threatDetectionRate 0.99 ;
    aegis:falsePositiveRate 0.01 ;
    aegis:propagationLatency "100ms" ;
    aegis:lookupLatency "10ms" ;
    aegis:throughput "100000" .

# 80/20 EXPANSION: Add all cybersecurity concepts referenced in workflows

# Assets (from workflow step names)
aegis:Asset a owl:Class ;
    rdfs:label "Cybersecurity Asset" ;
    rdfs:comment "Any resource that has value and needs protection" .

aegis:NetworkAsset rdfs:subClassOf aegis:Asset ;
    rdfs:label "Network Asset" .

aegis:ComputeAsset rdfs:subClassOf aegis:Asset ;
    rdfs:label "Compute Asset" .

aegis:DataAsset rdfs:subClassOf aegis:Asset ;
    rdfs:label "Data Asset" .

aegis:UserAsset rdfs:subClassOf aegis:Asset ;
    rdfs:label "User Asset" .

aegis:ApplicationAsset rdfs:subClassOf aegis:Asset ;
    rdfs:label "Application Asset" .

# Network Devices
aegis:NetworkDevice a owl:Class ;
    rdfs:label "Network Device" .

aegis:Router rdfs:subClassOf aegis:NetworkDevice ;
    rdfs:label "Router" .

aegis:Switch rdfs:subClassOf aegis:NetworkDevice ;
    rdfs:label "Switch" .

aegis:Firewall rdfs:subClassOf aegis:NetworkDevice ;
    rdfs:label "Firewall" .

aegis:LoadBalancer rdfs:subClassOf aegis:NetworkDevice ;
    rdfs:label "Load Balancer" .

aegis:VPN rdfs:subClassOf aegis:NetworkDevice ;
    rdfs:label "VPN" .

# Network Segments
aegis:NetworkSegment a owl:Class ;
    rdfs:label "Network Segment" .

aegis:DMZ rdfs:subClassOf aegis:NetworkSegment ;
    rdfs:label "DMZ" .

aegis:InternalNetwork rdfs:subClassOf aegis:NetworkSegment ;
    rdfs:label "Internal Network" .

aegis:PublicNetwork rdfs:subClassOf aegis:NetworkSegment ;
    rdfs:label "Public Network" .

# Threats and Attacks
aegis:Threat a owl:Class ;
    rdfs:label "Cybersecurity Threat" .

aegis:Malware rdfs:subClassOf aegis:Threat ;
    rdfs:label "Malware" .

aegis:Virus rdfs:subClassOf aegis:Malware ;
    rdfs:label "Virus" .

aegis:Worm rdfs:subClassOf aegis:Malware ;
    rdfs:label "Worm" .

aegis:Trojan rdfs:subClassOf aegis:Malware ;
    rdfs:label "Trojan" .

aegis:Ransomware rdfs:subClassOf aegis:Malware ;
    rdfs:label "Ransomware" .

aegis:Rootkit rdfs:subClassOf aegis:Malware ;
    rdfs:label "Rootkit" .

aegis:Spyware rdfs:subClassOf aegis:Malware ;
    rdfs:label "Spyware" .

aegis:Botnet rdfs:subClassOf aegis:Malware ;
    rdfs:label "Botnet" .

# Attack Types
aegis:Attack a owl:Class ;
    rdfs:label "Cyber Attack" .

aegis:NetworkAttack rdfs:subClassOf aegis:Attack ;
    rdfs:label "Network Attack" .

aegis:DDoSAttack rdfs:subClassOf aegis:NetworkAttack ;
    rdfs:label "DDoS Attack" .

aegis:ManInTheMiddleAttack rdfs:subClassOf aegis:NetworkAttack ;
    rdfs:label "Man in the Middle Attack" .

aegis:PacketSniffing rdfs:subClassOf aegis:NetworkAttack ;
    rdfs:label "Packet Sniffing" .

aegis:PortScan rdfs:subClassOf aegis:NetworkAttack ;
    rdfs:label "Port Scan" .

aegis:WebAttack rdfs:subClassOf aegis:Attack ;
    rdfs:label "Web Attack" .

aegis:SQLInjection rdfs:subClassOf aegis:WebAttack ;
    rdfs:label "SQL Injection" .

aegis:XSS rdfs:subClassOf aegis:WebAttack ;
    rdfs:label "Cross-Site Scripting" .

aegis:CSRF rdfs:subClassOf aegis:WebAttack ;
    rdfs:label "Cross-Site Request Forgery" .

aegis:SocialEngineering rdfs:subClassOf aegis:Attack ;
    rdfs:label "Social Engineering" .

aegis:PhishingAttack rdfs:subClassOf aegis:SocialEngineering ;
    rdfs:label "Phishing Attack" .

aegis:SpearPhishing rdfs:subClassOf aegis:PhishingAttack ;
    rdfs:label "Spear Phishing" .

aegis:PrivilegeEscalation rdfs:subClassOf aegis:Attack ;
    rdfs:label "Privilege Escalation" .

aegis:LateralMovement rdfs:subClassOf aegis:Attack ;
    rdfs:label "Lateral Movement" .

aegis:DataExfiltration rdfs:subClassOf aegis:Attack ;
    rdfs:label "Data Exfiltration" .

# Security Events and Incidents
aegis:SecurityEvent a owl:Class ;
    rdfs:label "Security Event" .

aegis:SecurityIncident rdfs:subClassOf aegis:SecurityEvent ;
    rdfs:label "Security Incident" .

aegis:Vulnerability a owl:Class ;
    rdfs:label "Vulnerability" .

aegis:ZeroDayVulnerability rdfs:subClassOf aegis:Vulnerability ;
    rdfs:label "Zero Day Vulnerability" .

aegis:Alert a owl:Class ;
    rdfs:label "Security Alert" .

aegis:ThreatIntelligence a owl:Class ;
    rdfs:label "Threat Intelligence" .

aegis:IOC a owl:Class ;
    rdfs:label "Indicator of Compromise" .

# Security Controls
aegis:SecurityControl a owl:Class ;
    rdfs:label "Security Control" .

aegis:PreventiveControl rdfs:subClassOf aegis:SecurityControl ;
    rdfs:label "Preventive Control" .

aegis:DetectiveControl rdfs:subClassOf aegis:SecurityControl ;
    rdfs:label "Detective Control" .

aegis:CorrectiveControl rdfs:subClassOf aegis:SecurityControl ;
    rdfs:label "Corrective Control" .

# Security Tools
aegis:SecurityTool a owl:Class ;
    rdfs:label "Security Tool" .

aegis:IDS rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Intrusion Detection System" .

aegis:IPS rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Intrusion Prevention System" .

aegis:SIEM rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Security Information and Event Management" .

aegis:Antivirus rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Antivirus" .

aegis:EDR rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Endpoint Detection and Response" .

aegis:SOAR rdfs:subClassOf aegis:SecurityTool ;
    rdfs:label "Security Orchestration, Automation and Response" .

# Properties for relationships
aegis:hasAsset a owl:ObjectProperty ;
    rdfs:domain aegis:NetworkSegment ;
    rdfs:range aegis:Asset .

aegis:threatenedBy a owl:ObjectProperty ;
    rdfs:domain aegis:Asset ;
    rdfs:range aegis:Threat .

aegis:protectedBy a owl:ObjectProperty ;
    rdfs:domain aegis:Asset ;
    rdfs:range aegis:SecurityControl .

aegis:detectedBy a owl:ObjectProperty ;
    rdfs:domain aegis:Threat ;
    rdfs:range aegis:SecurityTool .

aegis:mitigatedBy a owl:ObjectProperty ;
    rdfs:domain aegis:Vulnerability ;
    rdfs:range aegis:SecurityControl .

# Data Properties
aegis:severity a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:confidenceLevel a owl:DatatypeProperty ;
    rdfs:range xsd:float .

aegis:impactLevel a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:timestamp a owl:DatatypeProperty ;
    rdfs:range xsd:dateTime .

aegis:ipAddress a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:port a owl:DatatypeProperty ;
    rdfs:range xsd:int .

aegis:protocol a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:hash a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:fileSize a owl:DatatypeProperty ;
    rdfs:range xsd:long .

aegis:priority a owl:DatatypeProperty ;
    rdfs:range xsd:string .

aegis:status a owl:DatatypeProperty ;
    rdfs:range xsd:string .